<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DrunkFrog</title>
  <link href="style.css" rel="stylesheet" type="text/css" media="all">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/site.webmanifest">
</head>
<body onload="showExternalContent('post/catalog.html')">
  <img src="logo.png" alt="Shelton Logo" class="logo">
  <div class="window-body">
    <menu role="tablist">
      <li onclick="showExternalContent('post/catalog.html')" role="tab" aria-selected="true"><a href="#tabs">Catalog</a></li>
      <li onclick="showExternalContent('post/about_me.html')" role="tab" aria-selected="false"><a href="#tabs">About Me</a></li>
    </menu>
    <div class="window" role="tabpanel">
      <div class="window-body">
      </div>
    </div>
  </div>

  <button class="back-to-top" onclick="scrollToTop()">▲</button>

  <script>
    function showExternalContent(url) {
      console.log('showExternalContent called with url:', url);
      fetch(url)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok ' + response.statusText);
          }
          return response.text();
        })
        .then(data => {
          displayContent(data);
        })
        .catch(error => {
          console.error('Error loading external content:', error);
          displayError(error);
        });
    }

    function displayContent(html) {
    var content = document.querySelector('.window');
    content.classList.remove('active'); // 移除.active类
    var parser = new DOMParser();
    var doc = parser.parseFromString(html, "text/html");

    var externalTitle = doc.querySelector('title')?.innerText || "Default Title";
    var currentTitle = document.title.split(' - ')[0]; // 获取当前页面的原始标题
    document.title = currentTitle + " - " + externalTitle; // 将当前页面的原始标题与外部页面的title拼接

    var titleElement = document.createElement('h1');
    titleElement.textContent = externalTitle;

    var bodyContent = doc.querySelector('body').innerHTML;
    var content = document.querySelector('.window');
    content.innerHTML = '';

    var fragment = document.createDocumentFragment();
    fragment.appendChild(titleElement);

    var tempDiv = document.createElement('div');
    tempDiv.innerHTML = bodyContent;

    while (tempDiv.firstChild) {
    fragment.appendChild(tempDiv.firstChild);
  }

  content.appendChild(fragment);
  setTimeout(() => content.classList.add('active'), 10); // 添加.active类来触发动画
}

    function displayError(error) {
      var content = document.querySelector('.window');
      content.innerHTML = '<p>Error loading content: ' + error.message + '</p>';
      content.classList.add('active');
    }

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function handleScroll() {
      const button = document.querySelector('.back-to-top');
      if (window.scrollY > 300) { // 滚动距离大于300px时显示按钮
        button.style.display = 'block';
      } else {
        button.style.display = 'none';
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      const tabs = document.querySelectorAll('[role="tab"]');

      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          tabs.forEach(t => t.setAttribute('aria-selected', 'false'));
          this.setAttribute('aria-selected', 'true');
        });
      });

      window.addEventListener('scroll', handleScroll);
      handleScroll(); // 初始化时调用一次
    });
  </script>
  <div class="crt monitor"></div>
</body>
<div class="status-bar">
  <p class="status-bar-field"> Created by Shelton </p>
  <p class="status-bar-field"> Artistic by Cry </p>
</div>
</html>
